---
name: generate-stories
description: Generate stories from a resolved epic
user-invocable: false
allowed-tools: Bash(python:*), Read, AskUserQuestion, Skill(generate-story)
---

# Generate Stories Skill

The resolved epic is in the conversation context (passed from the command).

## Process

### 1. Extract Epic Information

Look for the epic slug in the conversation context. The `/generate-stories` command resolves the epic and passes the result.

If no epic slug is found, report an error:
```
Error: No epic information in context. This skill should be invoked by the /generate-stories command.
```

### 2. Read Epic Document

Read the epic file:
```
$CLAUDE_PROJECT_DIR/.claude-tasks/epics/<slug>/epic.md
```

**Important**: Read the full epic content. This context will be available to each story via fork.

### 3. Generate Story Breakdown (Titles + Descriptions Only)

Analyze the epic and generate a **lightweight breakdown**:

For each story, identify:
- `title`: Clear title describing the deliverable
- `description`: 1-2 sentence scope description

**Do NOT generate:**
- Slugs (generated by generate-story)
- Detailed content, tasks, acceptance criteria (generated by generate-story)

Focus on identifying logical story boundaries and ensuring stories don't overlap.

### 4. Present Story Breakdown for Approval

Display the proposed stories to the user:

```
## Proposed Stories for Epic: <slug>

### Story 1
**Title**: <title>
**Description**: <description>

### Story 2
**Title**: <title>
**Description**: <description>

...

---

Would you like to:
1. Approve and create all stories
2. Modify the breakdown
3. Cancel
```

Use AskUserQuestion to get approval.

### 5. Create Sibling Titles List

After approval, create a list of all story titles for boundary awareness:

```
sibling_titles:
  - "Login form component"
  - "Password reset API"
  - "Session management"
```

### 6. Fork Each Story

For each approved story, use the **Skill tool** to invoke `generate-story`.

The skill has `context: fork`, so each invocation:
- Inherits the full epic context (already read in step 2)
- Receives only this story's title/description + sibling titles
- Does NOT see other stories' detailed content

Pass to each generate-story invocation:
- `epic_slug`: The epic slug
- `story_title`: This story's title
- `story_description`: This story's description
- `sibling_titles`: List of ALL story titles (for boundary awareness)

### 7. Collect Results

Collect results from each generate-story invocation.

### 8. Report Completion

```
Stories created for epic: <slug>

| Story | Slug | Branch | PR |
|-------|------|--------|-----|
| <title> | <slug> | story-<epic>-<slug> | <pr-url> |
| ... | ... | ... | ... |

Worktrees created in: .claude-tasks/worktrees/<epic-slug>/

Next steps:
- Review story.md files and refine as needed
- Run /implement <story-slug> to start implementation
```

## Story Breakdown Guidelines

### Good Story Boundaries

**Good** (clear boundaries):
- "Login form component"
- "Password reset API endpoint"
- "Session token management"

**Bad** (too vague or too large):
- "Authentication" (too broad)
- "Add button" (too small)
- "Refactor and add tests" (multiple concerns)

### Why Fork?

Each generate-story invocation forks the current context, which includes:
- The full epic content (read in step 2)
- The lightweight breakdown (titles only)

But each forked context then generates its story in isolation, so:
- No context bloat from seeing all stories' full content
- Clear boundaries via sibling_titles
- Full epic context available for reference
